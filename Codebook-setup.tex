\newcommand{\Version}{2025-09-25}
% **************************************************
% Packages
% **************************************************
\usepackage{amsthm} % 定義，例題
\usepackage{amssymb} % 特殊符號
\usepackage{amsmath} % 數學排版
\usepackage{fontspec} % 設定字體
%\usepackage[T1]{fontenc}
\usepackage{xeCJK} % 使用中文字體
\usepackage{geometry} % 版面配置
\usepackage{color}
\usepackage[x11names]{xcolor}
\usepackage{listings} % 顯示code用的
%\usepackage[Glenn]{fncychap} % 排版，頁面模板
\usepackage{fancyhdr} % 設定頁首頁尾
\usepackage{graphicx} % Graphic
\usepackage{ifthen}
\usepackage{enumerate}
\usepackage{titlesec}
\usepackage{pdfpages}
\usepackage{multicol}

% **************************************************
% Information and Commands for Reuse
% **************************************************
% 將 section / subsection 標題字體設為 \small，保留編號
\titleformat{\section}
  {\small\bfseries}      % 格式：小一號、粗體
  {\thesection}          % 標號（一定要保留這個，編號才會顯示）
  {0.8em}                % 標號與標題文字間距
  {}

\titleformat{\subsection}
  {\small\bfseries}
  {\thesubsection}
  {0.8em}
  {}

%（可選）順便微調上下間距，避免字體變小後留白顯得太大
\titlespacing*{\section}{0pt}{1ex plus .2ex}{0.6ex}
\titlespacing*{\subsection}{0pt}{0.8ex plus .2ex}{0.5ex}

\newboolean{UsingGeometryLandscape}
\setboolean{UsingGeometryLandscape}{true} % 是否使用橫版頁面
\newcommand{\NumberOfColumn}{3} % 每頁有幾欄
\newcommand{\UniversityName}{National Tsing Hua University} % 學校名稱
\newcommand{\TeamName}{BlueCapeFlyingCat} % 隊名

\newcommand{\includecppwithhash}[3]{ % 支援 C++ (.cpp) 帶有 hash 值
  \subsection[#1]{#1 [#3]}
    \lstinputlisting[language=C++]{#2}
}

\newcommand{\includecpp}[2]{ % 支援 C++ (.cpp)
  \subsection{#1}
    \lstinputlisting[language=C++]{#2}
}

\newcommand{\includepy}[2]{ % 支援 Python (.py)
  \subsection{#1}
    \lstinputlisting[language=python]{#2}
}

\newcommand{\includetex}[2]{ % 支援 Latex (.tex)
  \subsection{#1}
    \input{#2}
}

\newcommand{\includevim}[2]{ % 支援 Vim (.vimrc)
  \subsection{#1}
    \lstinputlisting[language=vimrc]{#2}
}

% for debug
\newcommand{\geometrylen}[1]{\csname Gm@#1\endcsname}

% **************************************************
% Load and Configure
% **************************************************
\ifthenelse{\boolean{UsingGeometryLandscape}}{\geometry{landscape}}{}
\geometry{
  left=30pt,
  top=50pt,
}
\setlength{\columnsep}{15pt} % 兩欄之間的間距
\setlength{\columnseprule}{0pt}
\setlength{\textheight}{\paperheight-67pt}
\setlength{\textwidth}{\paperwidth-45pt}
%\topmargin=0pt
%\headsep=5pt
%\footskip=0pt
%\marginparsep=0pt
%\marginparwidth=0pt
%\marginparpush=0pt
%\oddsidemargin=0pt
%\evensidemargin=0pt

%\setmainfont{Consolas}
%\setmainfont{Linux Libertine G}
%\setmainfont{sourcecodepro}
\setromanfont[Path=fonts/]{times new roman.ttf}[ % 為了顯示國際歌
  BoldFont = times new roman bold.ttf,
]
\setmonofont[Path=fonts/]{consola.ttf}[ % 等寬字型
  BoldFont = consolab.ttf,
  ItalicFont = consolai.ttf,
]
\setCJKmainfont[Path=fonts/]{msjh.ttc} % 中文字型
\setCJKmonofont[Path=fonts/]{msjh.ttc} % 中文等寬字型
\XeTeXlinebreaklocale "zh" % 中文自動換行
\XeTeXlinebreakskip = 0pt plus 1pt % 設定段落之間的距離
\setcounter{secnumdepth}{3} % 目錄顯示第三層

\makeatletter
\lst@CCPutMacro\lst@ProcessOther {"2D}{\lst@ttfamily{-{}}{-{}}}
\@empty\z@\@empty
\makeatother

% **************************************************
% Listing Format (程式碼顯示)
% **************************************************
\lstset{
basicstyle=\scriptsize\ttfamily,        % the size of the fonts that are used for the code
numbers=left,                           % where to put the line-numbers
numberstyle=\tiny,                      % the size of the fonts that are used for the line-numbers
stepnumber=1,                           % the step between two line-numbers. If it's 1, each line  will be numbered
numbersep=5pt,                          % how far the line-numbers are from the code
backgroundcolor=\color{white},          % choose the background color. You must add \usepackage{color}
showspaces=false,                       % show spaces adding particular underscores
showstringspaces=false,                 % underline spaces within strings
showtabs=false,                         % show tabs within strings adding particular underscores
frame=false,                            % adds a frame around the code
tabsize=2,                              % sets default tabsize to 2 spaces
captionpos=b,                           % sets the caption-position to bottom
breaklines=true,                        % sets automatic line breaking
breakatwhitespace=false,                % sets if automatic breaks should only happen at whitespace
escapeinside={\%*}{*)},                 % if you want to add a comment within your code
morekeywords={*},                       % if you want to add more keywords to the set
keywordstyle=\bfseries\color{Blue1},
commentstyle=\itshape\color{Red4},
stringstyle=\itshape\color{Green4},
}
